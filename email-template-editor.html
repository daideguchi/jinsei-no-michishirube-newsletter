<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ¡ãƒ¼ãƒ«ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç·¨é›†ã‚·ã‚¹ãƒ†ãƒ  - äººç”Ÿã®é“æ¨™</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .template-preview {
            font-family: 'Hiragino Sans', 'Yu Gothic', sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background: #f8f8f8;
        }
        .email-content {
            background: white;
            padding: 30px;
            border-radius: 10px;
        }
        .section-box {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }
        .zen-gradient {
            background: linear-gradient(135deg, #2C5F41 0%, #4A7C59 100%);
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <nav class="bg-white shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <span class="text-2xl">âœ‰ï¸</span>
                    <span class="ml-2 text-xl font-bold text-gray-800">ãƒ¡ãƒ¼ãƒ«ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç·¨é›†</span>
                </div>
                <div class="flex items-center space-x-4">
                    <button onclick="saveToSheets()" class="zen-gradient text-white px-6 py-2 rounded-lg hover:opacity-90">
                        Google Sheetsã«ä¿å­˜
                    </button>
                    <button onclick="syncFromSheets()" class="border border-green-600 text-green-600 px-6 py-2 rounded-lg hover:bg-green-50">
                        Sheetsã‹ã‚‰èª­ã¿è¾¼ã¿
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <div class="max-w-7xl mx-auto px-4 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- å·¦å´: ç·¨é›†ã‚¨ãƒªã‚¢ -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h2 class="text-2xl font-bold mb-6">ğŸ“ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç·¨é›†</h2>
                
                <!-- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé¸æŠ -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’é¸æŠ</label>
                    <select id="templateSelect" onchange="loadTemplate()" class="w-full border-gray-300 rounded-lg">
                        <option value="welcome">ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒ¡ãƒ¼ãƒ«ï¼ˆç™»éŒ²ç›´å¾Œï¼‰</option>
                        <option value="day1">Day 1 - å¿ƒã‚’æ•´ãˆã‚‹æ™ºæ…§</option>
                        <option value="day3">Day 3 - äººé–“é–¢ä¿‚ã®æ™ºæ…§</option>
                        <option value="day7">Day 7 - ä¸€é€±é–“ã®æŒ¯ã‚Šè¿”ã‚Š</option>
                    </select>
                </div>

                <!-- ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ  -->
                <form id="templateForm" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">ä»¶å</label>
                        <input type="text" id="subject" class="w-full border-gray-300 rounded-lg px-3 py-2" 
                               placeholder="ã€äººç”Ÿã®é“æ¨™ã€‘ãƒ¡ãƒ¼ãƒ«ã®ä»¶å">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ†ã‚­ã‚¹ãƒˆ</label>
                        <input type="text" id="previewText" class="w-full border-gray-300 rounded-lg px-3 py-2"
                               placeholder="ãƒ¡ãƒ¼ãƒ«ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«è¡¨ç¤ºã•ã‚Œã‚‹çŸ­ã„èª¬æ˜æ–‡">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">ãƒ˜ãƒƒãƒ€ãƒ¼ã‚¿ã‚¤ãƒˆãƒ«</label>
                        <input type="text" id="headerTitle" class="w-full border-gray-300 rounded-lg px-3 py-2"
                               placeholder="ãƒ¡ãƒ¼ãƒ«æœ¬æ–‡ã®å†’é ­ã‚¿ã‚¤ãƒˆãƒ«">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">ãƒ¡ã‚¤ãƒ³æœ¬æ–‡</label>
                        <textarea id="mainContent" rows="4" class="w-full border-gray-300 rounded-lg px-3 py-2"
                                  placeholder="{firstName} æ§˜ã€æœ¬æ–‡ã‚’ã“ã“ã«å…¥åŠ›..."></textarea>
                        <p class="text-xs text-gray-500 mt-1">â€» {firstName} {lastName} ã§åå‰ãŒè‡ªå‹•æŒ¿å…¥ã•ã‚Œã¾ã™</p>
                    </div>

                    <!-- ã‚»ã‚¯ã‚·ãƒ§ãƒ³1 -->
                    <div class="border-t pt-4">
                        <h3 class="font-semibold mb-3">ã‚»ã‚¯ã‚·ãƒ§ãƒ³1</h3>
                        <input type="text" id="section1Title" class="w-full border-gray-300 rounded-lg px-3 py-2 mb-2"
                               placeholder="ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ã‚¿ã‚¤ãƒˆãƒ«">
                        <textarea id="section1Content" rows="3" class="w-full border-gray-300 rounded-lg px-3 py-2"
                                  placeholder="ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®å†…å®¹"></textarea>
                    </div>

                    <!-- ã‚»ã‚¯ã‚·ãƒ§ãƒ³2 -->
                    <div class="border-t pt-4">
                        <h3 class="font-semibold mb-3">ã‚»ã‚¯ã‚·ãƒ§ãƒ³2</h3>
                        <input type="text" id="section2Title" class="w-full border-gray-300 rounded-lg px-3 py-2 mb-2"
                               placeholder="ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰">
                        <textarea id="section2Content" rows="3" class="w-full border-gray-300 rounded-lg px-3 py-2"
                                  placeholder="ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®å†…å®¹ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰"></textarea>
                    </div>

                    <!-- ã‚»ã‚¯ã‚·ãƒ§ãƒ³3 -->
                    <div class="border-t pt-4">
                        <h3 class="font-semibold mb-3">ã‚»ã‚¯ã‚·ãƒ§ãƒ³3</h3>
                        <input type="text" id="section3Title" class="w-full border-gray-300 rounded-lg px-3 py-2 mb-2"
                               placeholder="ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰">
                        <textarea id="section3Content" rows="3" class="w-full border-gray-300 rounded-lg px-3 py-2"
                                  placeholder="ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®å†…å®¹ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰"></textarea>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">ç· ã‚ã®è¨€è‘‰</label>
                        <textarea id="closingMessage" rows="3" class="w-full border-gray-300 rounded-lg px-3 py-2"
                                  placeholder="ç· ã‚ããã‚Šã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"></textarea>
                    </div>
                </form>

                <button onclick="updatePreview()" class="w-full mt-6 bg-green-600 text-white py-3 rounded-lg hover:bg-green-700">
                    ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ›´æ–°
                </button>
            </div>

            <!-- å³å´: ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒªã‚¢ -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h2 class="text-2xl font-bold mb-6">ğŸ‘ï¸ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</h2>
                
                <!-- ãƒ¡ãƒ¼ãƒ«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ -->
                <div class="template-preview">
                    <!-- ãƒ¡ãƒ¼ãƒ«ãƒ˜ãƒƒãƒ€ãƒ¼ -->
                    <div class="mb-4 p-4 bg-gray-100 rounded">
                        <p class="text-sm text-gray-600">ä»¶å: <span id="previewSubject" class="font-semibold text-gray-800"></span></p>
                        <p class="text-sm text-gray-600 mt-1">å®›å…ˆ: sample@example.com</p>
                    </div>

                    <!-- ãƒ¡ãƒ¼ãƒ«æœ¬æ–‡ -->
                    <div class="email-content" id="emailPreview">
                        <!-- å‹•çš„ã«ç”Ÿæˆã•ã‚Œã‚‹ -->
                    </div>
                </div>

                <!-- çµ±è¨ˆæƒ…å ± -->
                <div class="mt-6 p-4 bg-blue-50 rounded-lg">
                    <h3 class="font-semibold text-blue-900 mb-2">ğŸ“Š é…ä¿¡çµ±è¨ˆ</h3>
                    <div class="text-sm text-blue-700 space-y-1">
                        <p>ã“ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®é–‹å°ç‡: <span class="font-semibold">32.5%</span></p>
                        <p>ã‚¯ãƒªãƒƒã‚¯ç‡: <span class="font-semibold">8.2%</span></p>
                        <p>æœ€çµ‚æ›´æ–°: <span id="lastUpdated">2025-07-26 10:00</span></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ä½¿ã„æ–¹ã‚¬ã‚¤ãƒ‰ -->
        <div class="mt-8 bg-yellow-50 rounded-xl p-6">
            <h3 class="text-xl font-bold mb-4">ğŸ’¡ ä½¿ã„æ–¹ã‚¬ã‚¤ãƒ‰</h3>
            <div class="grid md:grid-cols-3 gap-6">
                <div>
                    <h4 class="font-semibold mb-2">1ï¸âƒ£ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé¸æŠ</h4>
                    <p class="text-sm text-gray-700">ç·¨é›†ã—ãŸã„ãƒ¡ãƒ¼ãƒ«ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’é¸æŠã—ã¾ã™</p>
                </div>
                <div>
                    <h4 class="font-semibold mb-2">2ï¸âƒ£ å†…å®¹ç·¨é›†</h4>
                    <p class="text-sm text-gray-700">å„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ç·¨é›†ã—ã¦ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§ç¢ºèª</p>
                </div>
                <div>
                    <h4 class="font-semibold mb-2">3ï¸âƒ£ ä¿å­˜</h4>
                    <p class="text-sm text-gray-700">Google Sheetsã«ä¿å­˜ã™ã‚‹ã¨è‡ªå‹•é…ä¿¡ã«åæ˜ </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿
        const templates = {
            welcome: {
                subject: "ã€äººç”Ÿã®é“æ¨™ã€‘ã”ç™»éŒ²ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™",
                previewText: "æ˜æ—¥ã®æœ10æ™‚ã‹ã‚‰ã€7æ—¥é–“é€£ç¶šã§ã‚ãªãŸã®å¿ƒã‚’è±Šã‹ã«ã™ã‚‹æ™ºæ…§ã‚’ãŠé€ã‚Šã—ã¾ã™",
                headerTitle: "",
                mainContent: "{firstName} {lastName} æ§˜\n\nã€Œäººç”Ÿã®é“æ¨™ã€ãƒ¡ãƒ«ãƒã‚¬ã¸ã®ã”ç™»éŒ²ã€èª ã«ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚\n\næ˜æ—¥ã®æœ10æ™‚ã‹ã‚‰ã€7æ—¥é–“é€£ç¶šã§ã‚ãªãŸã®å¿ƒã‚’è±Šã‹ã«ã™ã‚‹æ™ºæ…§ã‚’ãŠé€ã‚Šã—ã¾ã™ã€‚",
                section1Title: "",
                section1Content: "",
                section2Title: "",
                section2Content: "",
                section3Title: "",
                section3Content: "",
                closingMessage: ""
            },
            day1: {
                subject: "ã€äººç”Ÿã®é“æ¨™ã€‘å¿ƒã‚’æ•´ãˆã‚‹æ™ºæ…§ã‚’ãŠå±Šã‘ã—ã¾ã™",
                previewText: "å¿™ã—ã„æ—¥å¸¸ã®ä¸­ã§ã‚‚å®Ÿè·µã§ãã‚‹ã€å¿ƒã‚’æ•´ãˆã‚‹3ã¤ã®æ–¹æ³•",
                headerTitle: "å¿ƒã‚’æ•´ãˆã‚‹3ã¤ã®å®Ÿè·µ",
                mainContent: "{firstName} æ§˜ã€ä»Šæ—¥ã¯å¿™ã—ã„æ—¥å¸¸ã®ä¸­ã§ã‚‚å®Ÿè·µã§ãã‚‹ã€å¿ƒã‚’æ•´ãˆã‚‹æ–¹æ³•ã‚’ãŠä¼ãˆã—ã¾ã™ã€‚",
                section1Title: "1. æœã®é™å¯‚ã®æ™‚é–“",
                section1Content: "ç›®è¦šã‚ãŸç›´å¾Œã®3åˆ†é–“ã€ä½•ã‚‚è€ƒãˆãšã€ãŸã å‘¼å¸ã«æ„è­˜ã‚’å‘ã‘ã¦ã¿ã¦ãã ã•ã„ã€‚å¿ƒã®ä¸­ã®é¨’ãŒã—ã•ãŒã€é™ã‹ã«æ²ˆã‚“ã§ã„ãã®ã‚’æ„Ÿã˜ã‚‰ã‚Œã‚‹ã§ã—ã‚‡ã†ã€‚",
                section2Title: "2. æ„Ÿè¬ã®ç™ºè¦‹",
                section2Content: "ä¸€æ—¥ã®çµ‚ã‚ã‚Šã«ã€ä»Šæ—¥èµ·ã“ã£ãŸå°ã•ãªã€Œã‚ã‚ŠãŒãŸã„ã“ã¨ã€ã‚’3ã¤æ€ã„æµ®ã‹ã¹ã¦ãã ã•ã„ã€‚æ—¥å¸¸ã«éš ã‚Œã¦ã„ã‚‹å¹¸ã›ã«æ°—ã¥ãåŠ›ãŒè‚²ã¾ã‚Œã¾ã™ã€‚",
                section3Title: "3. ãƒ‡ã‚¸ã‚¿ãƒ«ã®é™å¯‚",
                section3Content: "1æ—¥ã®ã†ã¡30åˆ†é–“ã€ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã‚’æ‰‹ã®å±Šã‹ãªã„å ´æ‰€ã«ç½®ã„ã¦ã¿ã¦ãã ã•ã„ã€‚å¿ƒã«ä½™ç™½ãŒç”Ÿã¾ã‚Œã€æœ¬å½“ã«å¤§åˆ‡ãªã“ã¨ã«æ„è­˜ãŒå‘ãã¾ã™ã€‚",
                closingMessage: "æ˜æ—¥ã¯ã€Œäººã¨ã®é–¢ã‚ã‚Šã®ä¸­ã§å¿ƒã‚’ä¿ã¤æ™ºæ…§ã€ã«ã¤ã„ã¦ãŠè©±ã—ã—ã¾ã™ã€‚"
            },
            day3: {
                subject: "ã€äººç”Ÿã®é“æ¨™ã€‘äººé–“é–¢ä¿‚ã®æ™ºæ…§",
                previewText: "äººã¨ã®é–¢ã‚ã‚Šã®ä¸­ã§å¿ƒç©ã‚„ã‹ã§ã„ã‚‹ãŸã‚ã®å¤æ¥ã®æ™ºæ…§",
                headerTitle: "äººé–“é–¢ä¿‚ã«æ´»ã‹ã™å¿ƒã®æ™ºæ…§",
                mainContent: "{firstName} æ§˜ã€äººã¨ã®é–¢ã‚ã‚Šã®ä¸­ã§å¿ƒç©ã‚„ã‹ã§ã„ã‚‹ãŸã‚ã®å¤æ¥ã®æ™ºæ…§ã‚’ãŠä¼ãˆã—ã¾ã™ã€‚",
                section1Title: "ç›¸æ‰‹ã®è¨€è‘‰ã®å¥¥ã‚’è´ã",
                section1Content: "äººãŒæ„Ÿæƒ…çš„ã«ãªã£ã¦ã„ã‚‹ã¨ãã€ãã®è¨€è‘‰ã§ã¯ãªãã€å¿ƒã®å¥¥ã«ã‚ã‚‹æ°—æŒã¡ã«è€³ã‚’å‚¾ã‘ã¦ã¿ã¦ãã ã•ã„ã€‚æ€’ã‚Šã®å¥¥ã«ã¯ä¸å®‰ã‚„æ‚²ã—ã¿ãŒã€æ‰¹åˆ¤ã®å¥¥ã«ã¯ç†è§£ã•ã‚ŒãŸã„æƒ³ã„ãŒã‚ã‚‹ã“ã¨ãŒå¤šã„ã‚‚ã®ã§ã™ã€‚",
                section2Title: "è‡ªåˆ†ã®åå¿œã‚’è¦³å¯Ÿã™ã‚‹",
                section2Content: "ç›¸æ‰‹ã®è¨€å‹•ã«å¿ƒãŒä¹±ã‚ŒãŸã¨ãã€ä¸€åº¦æ·±å‘¼å¸ã‚’ã—ã¦ã€Œä»Šã€ç§ã¯ã©ã‚“ãªæ°—æŒã¡ã«ãªã£ã¦ã„ã‚‹ã ã‚ã†ã€ã¨è‡ªåˆ†è‡ªèº«ã‚’è¦³å¯Ÿã—ã¦ã¿ã¦ãã ã•ã„ã€‚æ„Ÿæƒ…ã«é£²ã¿è¾¼ã¾ã‚Œãšã€é©åˆ‡ãªå¯¾å¿œãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚",
                section3Title: "",
                section3Content: "",
                closingMessage: "ã€Œç†è§£ã™ã‚‹ã“ã¨ã¨åŒæ„ã™ã‚‹ã“ã¨ã¯é•ã„ã¾ã™ã€‚\nç›¸æ‰‹ã‚’ç†è§£ã—ã‚ˆã†ã¨ã™ã‚‹å¿ƒãŒã€é–¢ä¿‚æ€§ã‚’æ·±ã‚ã¦ã„ãã®ã§ã™ã€‚ã€"
            },
            day7: {
                subject: "ã€äººç”Ÿã®é“æ¨™ã€‘ä¸€é€±é–“ã®æŒ¯ã‚Šè¿”ã‚Šã¨æ„Ÿè¬",
                previewText: "ä¸€é€±é–“ãŠä»˜ãåˆã„ã„ãŸã ãã€å¿ƒã‹ã‚‰æ„Ÿè¬ç”³ã—ä¸Šã’ã¾ã™",
                headerTitle: "ä¸€é€±é–“ã®æ­©ã¿ã¨æ„Ÿè¬",
                mainContent: "{firstName} æ§˜ã€ä¸€é€±é–“ãŠä»˜ãåˆã„ã„ãŸã ãã€å¿ƒã‹ã‚‰æ„Ÿè¬ç”³ã—ä¸Šã’ã¾ã™ã€‚\n\nã“ã®æ•°æ—¥é–“ã§ã€å°‘ã—ã§ã‚‚å¿ƒã«é™ã‘ã•ã‚„æ°—ã¥ããŒç”Ÿã¾ã‚ŒãŸã§ã—ã‚‡ã†ã‹ã€‚å°ã•ãªå¤‰åŒ–ã§ã‚‚ã€ãã‚Œã¯å¤§ããªä¸€æ­©ã§ã™ã€‚",
                section1Title: "ã“ã‚Œã‹ã‚‰ã‚‚å¿ƒã«ç•™ã‚ã¦ã„ãŸã ããŸã„ã“ã¨",
                section1Content: "ãƒ»å®Œç’§ã‚’æ±‚ã‚ãšã€ä»Šã“ã®ç¬é–“ã‚’å¤§åˆ‡ã«ã™ã‚‹ã“ã¨\nãƒ»å°ã•ãªæ„Ÿè¬ã‚’è¦‹ã¤ã‘ã‚‹ç¿’æ…£ã‚’ç¶šã‘ã‚‹ã“ã¨\nãƒ»å¿ƒãŒä¹±ã‚Œã¦ã‚‚ã€ãã‚Œã«æ°—ã¥ãè‡ªåˆ†ã‚’è¤’ã‚ã‚‹ã“ã¨\nãƒ»ä»–è€…ã¨ã®é–¢ã‚ã‚Šã®ä¸­ã§ã€ç†è§£ã™ã‚‹å¿ƒã‚’æŒã¡ç¶šã‘ã‚‹ã“ã¨",
                section2Title: "",
                section2Content: "",
                section3Title: "",
                section3Content: "",
                closingMessage: "äººç”Ÿã¨ã„ã†é“ã®ã‚Šã§ã€æ™‚ã«ã¯è¿·ã†ã“ã¨ã‚‚ã‚ã‚‹ã§ã—ã‚‡ã†ã€‚ãã‚“ãªã¨ãã€ã“ã“ã§ãŠä¼ãˆã—ãŸæ™ºæ…§ã‚’æ€ã„å‡ºã—ã¦ã„ãŸã ã‘ã‚Œã°å¹¸ã„ã§ã™ã€‚\n\nä»Šå¾Œã‚‚æ™‚ã€…ã€å¿ƒã®æ „é¤Šã¨ãªã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãŠå±Šã‘ã„ãŸã—ã¾ã™ã€‚\nå¼•ãç¶šãã€ã©ã†ãã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚"
            }
        };

        // åˆæœŸåŒ–
        window.onload = function() {
            loadTemplate();
        };

        // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆèª­ã¿è¾¼ã¿
        function loadTemplate() {
            const templateId = document.getElementById('templateSelect').value;
            const template = templates[templateId];
            
            document.getElementById('subject').value = template.subject;
            document.getElementById('previewText').value = template.previewText;
            document.getElementById('headerTitle').value = template.headerTitle;
            document.getElementById('mainContent').value = template.mainContent;
            document.getElementById('section1Title').value = template.section1Title;
            document.getElementById('section1Content').value = template.section1Content;
            document.getElementById('section2Title').value = template.section2Title;
            document.getElementById('section2Content').value = template.section2Content;
            document.getElementById('section3Title').value = template.section3Title;
            document.getElementById('section3Content').value = template.section3Content;
            document.getElementById('closingMessage').value = template.closingMessage;
            
            updatePreview();
        }

        // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ›´æ–°
        function updatePreview() {
            const subject = document.getElementById('subject').value;
            const headerTitle = document.getElementById('headerTitle').value;
            const mainContent = document.getElementById('mainContent').value
                .replace(/\n/g, '<br>')
                .replace(/{firstName}/g, 'ç”°ä¸­')
                .replace(/{lastName}/g, 'å¤ªéƒ');
            
            const section1Title = document.getElementById('section1Title').value;
            const section1Content = document.getElementById('section1Content').value.replace(/\n/g, '<br>');
            const section2Title = document.getElementById('section2Title').value;
            const section2Content = document.getElementById('section2Content').value.replace(/\n/g, '<br>');
            const section3Title = document.getElementById('section3Title').value;
            const section3Content = document.getElementById('section3Content').value.replace(/\n/g, '<br>');
            const closingMessage = document.getElementById('closingMessage').value.replace(/\n/g, '<br>');
            
            document.getElementById('previewSubject').textContent = subject;
            
            let htmlContent = '';
            
            if (headerTitle) {
                htmlContent += `<h2 style="color: #2C5F41; font-size: 20px; margin-bottom: 20px;">${headerTitle}</h2>`;
            }
            
            if (mainContent) {
                htmlContent += `<p style="color: #333; line-height: 1.7; margin-bottom: 25px;">${mainContent}</p>`;
            }
            
            if (section1Title && section1Content) {
                htmlContent += `<div class="section-box">
                    <h3 style="color: #2C5F41; font-size: 16px; margin-bottom: 15px;">${section1Title}</h3>
                    <p style="color: #333; line-height: 1.6;">${section1Content}</p>
                </div>`;
            }
            
            if (section2Title && section2Content) {
                htmlContent += `<div class="section-box">
                    <h3 style="color: #2C5F41; font-size: 16px; margin-bottom: 15px;">${section2Title}</h3>
                    <p style="color: #333; line-height: 1.6;">${section2Content}</p>
                </div>`;
            }
            
            if (section3Title && section3Content) {
                htmlContent += `<div class="section-box">
                    <h3 style="color: #2C5F41; font-size: 16px; margin-bottom: 15px;">${section3Title}</h3>
                    <p style="color: #333; line-height: 1.6;">${section3Content}</p>
                </div>`;
            }
            
            if (closingMessage) {
                htmlContent += `<p style="color: #333; line-height: 1.7; margin-top: 25px;">${closingMessage}</p>`;
            }
            
            document.getElementById('emailPreview').innerHTML = htmlContent;
            document.getElementById('lastUpdated').textContent = new Date().toLocaleString('ja-JP');
        }

        // Google Sheetsã«ä¿å­˜ï¼ˆå®Ÿéš›ã®å®Ÿè£…ã§ã¯ API å‘¼ã³å‡ºã—ï¼‰
        async function saveToSheets() {
            const templateId = document.getElementById('templateSelect').value;
            const data = {
                templateId: templateId,
                subject: document.getElementById('subject').value,
                previewText: document.getElementById('previewText').value,
                headerTitle: document.getElementById('headerTitle').value,
                mainContent: document.getElementById('mainContent').value,
                section1Title: document.getElementById('section1Title').value,
                section1Content: document.getElementById('section1Content').value,
                section2Title: document.getElementById('section2Title').value,
                section2Content: document.getElementById('section2Content').value,
                section3Title: document.getElementById('section3Title').value,
                section3Content: document.getElementById('section3Content').value,
                closingMessage: document.getElementById('closingMessage').value,
                lastUpdated: new Date().toISOString()
            };
            
            try {
                // APIå‘¼ã³å‡ºã—ï¼ˆå®Ÿè£…å¿…è¦ï¼‰
                alert('âœ… Google Sheetsã«ä¿å­˜ã—ã¾ã—ãŸï¼\n\nä¿å­˜ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿:\n' + JSON.stringify(data, null, 2));
                
                // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ã‚‚ä¿å­˜
                localStorage.setItem(`template_${templateId}`, JSON.stringify(data));
            } catch (error) {
                alert('âŒ ä¿å­˜ã‚¨ãƒ©ãƒ¼: ' + error.message);
            }
        }

        // Google Sheetsã‹ã‚‰èª­ã¿è¾¼ã¿ï¼ˆå®Ÿéš›ã®å®Ÿè£…ã§ã¯ API å‘¼ã³å‡ºã—ï¼‰
        async function syncFromSheets() {
            try {
                alert('ğŸ“¥ Google Sheetsã‹ã‚‰èª­ã¿è¾¼ã¿ä¸­...\n\nï¼ˆã“ã®æ©Ÿèƒ½ã¯ API é€£æºå®Ÿè£…å¾Œã«åˆ©ç”¨å¯èƒ½ã«ãªã‚Šã¾ã™ï¼‰');
                // APIå®Ÿè£…å¾Œã«ã“ã“ã«å‡¦ç†ã‚’è¿½åŠ 
            } catch (error) {
                alert('âŒ èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼: ' + error.message);
            }
        }
    </script>
</body>
</html>